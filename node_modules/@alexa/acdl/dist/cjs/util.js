"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getDirectoriesSync = exports.getDirectories = exports.isAmazonBuiltin = exports.isGeneratedFile = exports.typesToNameString = exports.isNotUndefined = exports.isBuiltinSlotType = exports.zipDirectory = exports.log = exports.sanitize = exports.stringifyTypeParameter = exports.stringifyTypeReference = exports.isQualifiedNamePattern = exports.getName = exports.getNamespace = exports.safeFs = exports.safeFsSync = exports.lstat = exports.stat = exports.statSync = exports.isDir = exports.isDirSync = exports.isFile = exports.isFileSync = exports.readFile = exports.readFileSync = exports.readJsonFile = exports.readJsonFileSync = exports.readAndParseMandatoryJSONFileSync = exports.parseJSON = exports.readdir = exports.exists = exports.existsSync = exports.trimScheme = exports.time = void 0;
const fs_extra_1 = __importDefault(require("fs-extra"));
const archiver_1 = __importDefault(require("archiver"));
const ask = __importStar(require("./ast"));
const constants_1 = require("./constants");
const error_1 = require("./error");
function time(description, f) {
    // const start = new Date().getTime();
    const result = f();
    if (typeof result.then === "function") {
        return result.then((result) => {
            emit();
            return result;
        });
    }
    emit();
    return result;
    function emit() {
        // console.log(description, `${new Date().getTime() - start}ms`);
    }
}
exports.time = time;
function trimScheme(uri) {
    if (uri.startsWith("file://")) {
        return uri.slice("file://".length);
    }
    return uri;
}
exports.trimScheme = trimScheme;
/**
 * Asynchronously check if a file exists
 */
function existsSync(file) {
    try {
        fs_extra_1.default.accessSync(file, fs_extra_1.default.constants.R_OK);
        return true;
    }
    catch (err) {
        if (err.code === "ENOENT") {
            return false;
        }
        throw err;
    }
}
exports.existsSync = existsSync;
/**
 * Asynchronously check if a file exists
 */
async function exists(file) {
    try {
        await fs_extra_1.default.access(file, fs_extra_1.default.constants.R_OK);
        return true;
    }
    catch (err) {
        if (err.code === "ENOENT") {
            return false;
        }
        throw err;
    }
}
exports.exists = exists;
async function readdir(dir) {
    return fs_extra_1.default.readdir(dir);
}
exports.readdir = readdir;
/**
 * Parses JSON throwing an error that includes the path if the JSON is invalid
 * @param jsonText text to be parsed
 * @param path path the text came from
 */
function parseJSON(jsonText, path) {
    try {
        return JSON.parse(jsonText);
    }
    catch (error) {
        throw new error_1.FileError(`Error parsing JSON in "${path}": ${error.message}.`, path);
    }
}
exports.parseJSON = parseJSON;
/**
 * Reads a file and parses the JSON throwing an error that includes the path if
 * cannot read file or if the JSON is invalid
 * @param path path of file to read
 * @returns the JSON object read from the file
 */
function readAndParseMandatoryJSONFileSync(path) {
    const fileContents = readJsonFileSync(path);
    if (!fileContents) {
        throw new error_1.FileError(`Error reading file "${path}".`, path);
    }
    return fileContents;
}
exports.readAndParseMandatoryJSONFileSync = readAndParseMandatoryJSONFileSync;
function readJsonFileSync(filePath) {
    const file = readFileSync(filePath);
    if (file === undefined) {
        return undefined;
    }
    return parseJSON(file, filePath);
}
exports.readJsonFileSync = readJsonFileSync;
async function readJsonFile(filePath) {
    const file = await readFile(filePath);
    if (file === undefined) {
        return undefined;
    }
    return parseJSON(file, filePath);
}
exports.readJsonFile = readJsonFile;
function readFileSync(path) {
    if (existsSync(path)) {
        return fs_extra_1.default.readFileSync(path).toString("utf8");
    }
    return undefined;
}
exports.readFileSync = readFileSync;
async function readFile(path) {
    if (await exists(path)) {
        return (await fs_extra_1.default.readFile(path)).toString("utf8");
    }
    return undefined;
}
exports.readFile = readFile;
function isFileSync(path) {
    var _a;
    return (_a = statSync(path)) === null || _a === void 0 ? void 0 : _a.isFile();
}
exports.isFileSync = isFileSync;
async function isFile(path) {
    var _a;
    return (_a = (await stat(path))) === null || _a === void 0 ? void 0 : _a.isFile();
}
exports.isFile = isFile;
function isDirSync(path) {
    var _a;
    return ((_a = statSync(path)) === null || _a === void 0 ? void 0 : _a.isDirectory()) === true;
}
exports.isDirSync = isDirSync;
async function isDir(path) {
    var _a;
    return ((_a = (await stat(path))) === null || _a === void 0 ? void 0 : _a.isDirectory()) === true;
}
exports.isDir = isDir;
function statSync(path) {
    return safeFsSync(() => fs_extra_1.default.statSync(path));
}
exports.statSync = statSync;
async function stat(path) {
    return safeFs(() => fs_extra_1.default.stat(path));
}
exports.stat = stat;
async function lstat(path) {
    return safeFs(() => fs_extra_1.default.lstat(path));
}
exports.lstat = lstat;
function safeFsSync(f) {
    try {
        return f();
    }
    catch (err) {
        if (err.code === "ENOENT") {
            // file doesn't exist, so stat is undefined
            return undefined;
        }
        // we can't read the file, throw the error
        throw err;
    }
}
exports.safeFsSync = safeFsSync;
async function safeFs(f) {
    try {
        const t = f();
        if (t.then && t.catch) {
            return await t;
        }
        return t;
    }
    catch (err) {
        if (err.code === "ENOENT") {
            // file doesn't exist, so stat is undefined
            return undefined;
        }
        // we can't read the file, throw the error
        throw err;
    }
}
exports.safeFs = safeFs;
function getNamespace(fqn) {
    return fqn.slice(0, fqn.lastIndexOf("."));
}
exports.getNamespace = getNamespace;
function getName(fqn) {
    return fqn.slice(fqn.lastIndexOf(".") + 1);
}
exports.getName = getName;
function isQualifiedNamePattern(name) {
    // poor man's algorithm for now - TODO: use regex from spec
    return name !== undefined && name.includes(".");
}
exports.isQualifiedNamePattern = isQualifiedNamePattern;
function stringifyTypeReference(ref) {
    var _a;
    if (ref === undefined) {
        return ask.AlexaSchema.Thing;
    }
    return `${(_a = ref.name) === null || _a === void 0 ? void 0 : _a.name}${ref.arguments ? `<${ref.arguments.map((arg) => stringifyTypeReference(arg))}>` : ""}`;
}
exports.stringifyTypeReference = stringifyTypeReference;
function stringifyTypeParameter(param) {
    return `T${param.constraints ? ` : ${param.constraints.map(stringifyTypeReference).join(", ")}` : ""}`;
}
exports.stringifyTypeParameter = stringifyTypeParameter;
function sanitize(a) {
    if (a === undefined) {
        return undefined;
    }
    if (a === null) {
        return a;
    }
    if (typeof a === "object") {
        if (Array.isArray(a)) {
            if (a.length === 0) {
                return undefined;
            }
        }
        else if (Object.keys(a).length === 0) {
            return undefined;
        }
    }
    return a;
}
exports.sanitize = sanitize;
function log(a, keepLoc) {
    if (a === undefined) {
        console.log("");
    }
    else if (typeof a === "string") {
        console.log(a);
    }
    else {
        console.log(JSON.stringify(a, (k, v) => (k === "loc" && keepLoc !== true ? undefined : k === "parent" ? undefined : v), 2));
    }
}
exports.log = log;
function zipDirectory(source, out) {
    const archive = (0, archiver_1.default)("zip", { zlib: { level: 9 } });
    const stream = fs_extra_1.default.createWriteStream(out);
    return new Promise((resolve, reject) => {
        archive
            .directory(source, false)
            .on("error", (err) => reject(err))
            .pipe(stream);
        stream.on("close", () => resolve(undefined));
        archive.finalize();
    });
}
exports.zipDirectory = zipDirectory;
function isBuiltinSlotType(slotName) {
    return slotName.startsWith("AMAZON.");
}
exports.isBuiltinSlotType = isBuiltinSlotType;
function isNotUndefined(value) {
    return value !== undefined;
}
exports.isNotUndefined = isNotUndefined;
/**
 * Stringifies a type array to their short type names
 */
function typesToNameString(types) {
    return types.map((type) => `"${type.shortName}"`).join(", ");
}
exports.typesToNameString = typesToNameString;
/**
 * Returns if this file is generated ASKIR module.
 */
function isGeneratedFile(fileName) {
    return fileName.includes(constants_1.GeneratedInteractionModelModule.uriPrefix);
}
exports.isGeneratedFile = isGeneratedFile;
/**
 * returns if the string starts with AMAZON.
 */
function isAmazonBuiltin(name) {
    return name.startsWith(constants_1.Constants.BuiltinIntentPrefix);
}
exports.isAmazonBuiltin = isAmazonBuiltin;
/**
 * gets all directories recursively under parentDirectoryPath
 * @param parentDirectoryPath path of parentDirectory
 * @returns an array of all directories recursively under parentDirectoryPath
 */
async function getDirectories(parentDirectoryPath) {
    return (await fs_extra_1.default.readdir(parentDirectoryPath, { withFileTypes: true }))
        .filter((dir) => dir.isDirectory())
        .map((dir) => dir.name);
}
exports.getDirectories = getDirectories;
/**
 * gets all directories recursively under parentDirectoryPath
 * @param parentDirectoryPath path of parentDirectory
 * @returns an array of all directories recursively under parentDirectoryPath
 */
function getDirectoriesSync(parentDirectoryPath) {
    return fs_extra_1.default
        .readdirSync(parentDirectoryPath, { withFileTypes: true })
        .filter((dir) => dir.isDirectory())
        .map((dir) => dir.name);
}
exports.getDirectoriesSync = getDirectoriesSync;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsd0RBQTBCO0FBRTFCLHdEQUFnQztBQUNoQywyQ0FBNkI7QUFFN0IsMkNBQXVFO0FBQ3ZFLG1DQUFrQztBQUlsQyxTQUFnQixJQUFJLENBQUksV0FBbUIsRUFBRSxDQUF1QjtJQUNsRSxzQ0FBc0M7SUFDdEMsTUFBTSxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7SUFDbkIsSUFBSSxPQUFRLE1BQXFCLENBQUMsSUFBSSxLQUFLLFVBQVUsRUFBRTtRQUNyRCxPQUFRLE1BQXFCLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUU7WUFDNUMsSUFBSSxFQUFFLENBQUM7WUFDUCxPQUFPLE1BQU0sQ0FBQztRQUNoQixDQUFDLENBQUMsQ0FBQztLQUNKO0lBQ0QsSUFBSSxFQUFFLENBQUM7SUFDUCxPQUFPLE1BQU0sQ0FBQztJQUVkLFNBQVMsSUFBSTtRQUNYLGlFQUFpRTtJQUNuRSxDQUFDO0FBQ0gsQ0FBQztBQWZELG9CQWVDO0FBRUQsU0FBZ0IsVUFBVSxDQUFDLEdBQVc7SUFDcEMsSUFBSSxHQUFHLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxFQUFFO1FBQzdCLE9BQU8sR0FBRyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUM7S0FDcEM7SUFDRCxPQUFPLEdBQUcsQ0FBQztBQUNiLENBQUM7QUFMRCxnQ0FLQztBQUVEOztHQUVHO0FBQ0gsU0FBZ0IsVUFBVSxDQUFDLElBQVk7SUFDckMsSUFBSTtRQUNGLGtCQUFFLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxrQkFBRSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN2QyxPQUFPLElBQUksQ0FBQztLQUNiO0lBQUMsT0FBTyxHQUFRLEVBQUU7UUFDakIsSUFBSSxH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