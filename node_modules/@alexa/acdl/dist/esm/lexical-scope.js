import immutable from "immutable";
export function emptyLexicalScope() {
    return immutable.Map();
}
/**
 * Computes the lexical scope for an array of named expressions.
 */
export function computeLexicalScope(expressions) {
    var _a;
    return ((_a = expressions === null || expressions === void 0 ? void 0 : expressions.map((expr) => {
        var _a;
        return ((_a = expr.name) === null || _a === void 0 ? void 0 : _a.name)
            ? immutable.Map([[expr.name.name, expr]])
            : immutable.Map();
    }).reduce(mergeLexicalScope, emptyLexicalScope())) !== null && _a !== void 0 ? _a : emptyLexicalScope());
}
export function mergeLexicalScope(a, b) {
    return a.mergeWith(mergeLexicalScopeNode, b);
}
export function mergeLexicalScopeNode(a, b) {
    return a === undefined && b === undefined
        ? undefined
        : a === undefined
            ? b
            : b === undefined
                ? a
                : Array.isArray(a) && Array.isArray(b)
                    ? a.concat(b)
                    : Array.isArray(a)
                        ? [...a, b]
                        : Array.isArray(b)
                            ? [a, ...b]
                            : [a, b];
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGV4aWNhbC1zY29wZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9sZXhpY2FsLXNjb3BlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sU0FBUyxNQUFNLFdBQVcsQ0FBQztBQVNsQyxNQUFNLFVBQVUsaUJBQWlCO0lBQy9CLE9BQU8sU0FBUyxDQUFDLEdBQUcsRUFBNkMsQ0FBQztBQUNwRSxDQUFDO0FBSUQ7O0dBRUc7QUFDSCxNQUFNLFVBQVUsbUJBQW1CLENBQUMsV0FBNkM7O0lBQy9FLE9BQU8sQ0FDTCxNQUFBLFdBQVcsYUFBWCxXQUFXLHVCQUFYLFdBQVcsQ0FDUCxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTs7UUFDYixPQUFBLENBQUEsTUFBQSxJQUFJLENBQUMsSUFBSSwwQ0FBRSxJQUFJO1lBQ2IsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQTRDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFnQixDQUFDLENBQUMsQ0FBQztZQUNoRyxDQUFDLENBQUMsU0FBUyxDQUFDLEdBQUcsRUFBNkMsQ0FBQTtLQUFBLEVBRS9ELE1BQU0sQ0FBQyxpQkFBaUIsRUFBRSxpQkFBaUIsRUFBRSxDQUFDLG1DQUFJLGlCQUFpQixFQUFFLENBQ3pFLENBQUM7QUFDSixDQUFDO0FBRUQsTUFBTSxVQUFVLGlCQUFpQixDQUFDLENBQWUsRUFBRSxDQUFlO0lBQ2hFLE9BQU8sQ0FBQyxDQUFDLFNBQVMsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDLENBQUMsQ0FBQztBQUMvQyxDQUFDO0FBRUQsTUFBTSxVQUFVLHFCQUFxQixDQUFDLENBQW9DLEVBQUUsQ0FBb0M7SUFDOUcsT0FBTyxDQUFDLEtBQUssU0FBUyxJQUFJLENBQUMsS0FBSyxTQUFTO1FBQ3ZDLENBQUMsQ0FBQyxTQUFTO1FBQ1gsQ0FBQyxDQUFDLENBQUMsS0FBSyxTQUFTO1lBQ2pCLENBQUMsQ0FBQyxDQUFDO1lBQ0gsQ0FBQyxDQUFDLENBQUMsS0FBSyxTQUFTO2dCQUNqQixDQUFDLENBQUMsQ0FBQztnQkFDSCxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztvQkFDdEMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO29CQUNiLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQzt3QkFDbEIsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBYSxDQUFDO3dCQUN2QixDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7NEJBQ2xCLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQzs0QkFDWCxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDYixDQUFDIn0=