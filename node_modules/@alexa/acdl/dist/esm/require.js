import path from "path";
import resolve from "resolve";
import { AlexaConversations } from "./ast";
import { trimScheme } from "./util";
;
/**
 *
 * @param apply
 */
export function resolveRequirePath(apply) {
    var _a, _b, _c;
    const name = (_a = apply.decl.name) === null || _a === void 0 ? void 0 : _a.name;
    const { checker } = apply;
    if (name === AlexaConversations.apl || name === AlexaConversations.apla) {
        const pathArg = (_b = apply.getArguments()) === null || _b === void 0 ? void 0 : _b.path;
        if (((_c = pathArg === null || pathArg === void 0 ? void 0 : pathArg.value) === null || _c === void 0 ? void 0 : _c.kind) === "Call") {
            const filePath = pathArg.value.arguments;
            if (typeof filePath === "string") {
                const uri = checker.getUri(apply.call);
                if (uri !== undefined) {
                    try {
                        const foundPath = resolve.sync(filePath, {
                            basedir: path.dirname(trimScheme(uri)),
                        });
                        return foundPath;
                    }
                    catch (err) {
                        console.error(err);
                        return undefined;
                    }
                }
            }
        }
    }
    return undefined;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVxdWlyZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9yZXF1aXJlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sSUFBSSxNQUFNLE1BQU0sQ0FBQztBQUN4QixPQUFPLE9BQU8sTUFBTSxTQUFTLENBQUM7QUFHOUIsT0FBTyxFQUFDLGtCQUFrQixFQUFDLE1BQU0sT0FBTyxDQUFDO0FBQ3pDLE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxRQUFRLENBQUM7QUFFbEMsQ0FBQztBQUVEOzs7R0FHRztBQUNILE1BQU0sVUFBVSxrQkFBa0IsQ0FBQyxLQUFZOztJQUM3QyxNQUFNLElBQUksR0FBRyxNQUFBLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSwwQ0FBRSxJQUFJLENBQUM7SUFDbkMsTUFBTSxFQUFDLE9BQU8sRUFBQyxHQUFHLEtBQUssQ0FBQztJQUN4QixJQUFJLElBQUksS0FBSyxrQkFBa0IsQ0FBQyxHQUFHLElBQUksSUFBSSxLQUFLLGtCQUFrQixDQUFDLElBQUksRUFBRTtRQUN2RSxNQUFNLE9BQU8sR0FBRyxNQUFBLEtBQUssQ0FBQyxZQUFZLEVBQUUsMENBQUUsSUFBSSxDQUFDO1FBQzNDLElBQUksQ0FBQSxNQUFBLE9BQU8sYUFBUCxPQUFPLHVCQUFQLE9BQU8sQ0FBRSxLQUFLLDBDQUFFLElBQUksTUFBSyxNQUFNLEVBQUU7WUFDbkMsTUFBTSxRQUFRLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUM7WUFDekMsSUFBSSxPQUFPLFFBQVEsS0FBSyxRQUFRLEVBQUU7Z0JBQ2hDLE1BQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUN2QyxJQUFJLEdBQUcsS0FBSyxTQUFTLEVBQUU7b0JBQ3JCLElBQUk7d0JBQ0YsTUFBTSxTQUFTLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUU7NEJBQ3ZDLE9BQU8sRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQzt5QkFDdkMsQ0FBQyxDQUFDO3dCQUNILE9BQU8sU0FBUyxDQUFDO3FCQUNsQjtvQkFBQyxPQUFPLEdBQUcsRUFBRTt3QkFDWixPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO3dCQUNuQixPQUFPLFNBQVMsQ0FBQztxQkFDbEI7aUJBQ0Y7YUFDRjtTQUNGO0tBQ0Y7SUFDRCxPQUFPLFNBQVMsQ0FBQztBQUNuQixDQUFDIn0=